bg.color = "grey30",  # Color del borde (sombra)
bg.r = 0.1,  # Radio de la sombra (ajústalo según necesites)
size = 4
) +
scale_fill_manual(values = colors,
labels = c(`1` = "Esfuerzo",
`2` = "Ambos",
`3` = "Talento")) +
labs(
x = NULL,
y = NULL,
fill = "Preferencia",
title = "Figura 10: ¿Qué es más importante para obtener buenas notas, \nel esfuerzo o la inteligencia?") +
theme_blank() +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
strip.text = element_text(size = 9, face = "bold"),
axis.text.x = element_text(size = 9),
legend.position = "right",
plot.title = element_text(size = 12, face = "italic", color = "black")
) +
scale_fill_manual(values = colors,
labels = c(`1` = "Esfuerzo",
`5` = "Ambos",
`10` = "Talento"))
# Calcular las frecuencias con la pregunta correspondiente
frecuencias <- proc_datos_largo %>%
group_by(variable, categoria, p3) %>%
summarise(Freq = n(), .groups = 'drop') %>%
left_join(frecuencias_originales, by = c("variable", "categoria")) %>%
mutate(Porcentaje = Freq / Freq_Original) %>%
ungroup() %>%
na.omit()
# Ajustar los nombres
variable_names <- list("educ_max" = "Nivel educacional \nde los padres",
"genero_ES" = "Género",
"libros_hogar" = "Cantidad de libros en el hogar")
variable_labeller <- function(variable, value){return(variable_names[value])}
# Ajustar las etiquetas largas
frecuencias$categoria <- str_wrap(frecuencias$categoria, width = 10)
colors <-  c("#0570b0ff", "#D0EAF1",
"#6C3483")
# Graficar las barras
ggplot(frecuencias, aes(x = categoria, y = Porcentaje, fill = factor(p3))) +
geom_bar(stat = "identity", position = "fill", color = "white") +
facet_wrap(~ variable, scales = "free_x", labeller = as_labeller(variable_labeller)) +
geom_shadowtext(aes(label = scales::percent(Porcentaje, accuracy = 1)),
position = position_stack(vjust = 0.5),
color = "white",   # Color del texto interno
bg.color = "grey30",  # Color del borde (sombra)
bg.r = 0.1,  # Radio de la sombra (ajústalo según necesites)
size = 4
) +
labs(
x = NULL,
y = NULL,
fill = "Preferencia",
title = "Figura 10: ¿Qué es más importante para obtener buenas notas, \nel esfuerzo o la inteligencia?") +
theme_blank() +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
strip.text = element_text(size = 9, face = "bold"),
axis.text.x = element_text(size = 9),
legend.position = "right",
plot.title = element_text(size = 12, face = "italic", color = "black")
) +
scale_fill_manual(values = colors,
labels = c(`1` = "Esfuerzo",
`2` = "Ambos",
`3` = "Talento"))
# Calcular las frecuencias con la pregunta correspondiente
frecuencias <- proc_datos_largo %>%
group_by(variable, categoria, p3) %>%
summarise(Freq = n(), .groups = 'drop') %>%
left_join(frecuencias_originales, by = c("variable", "categoria")) %>%
mutate(Porcentaje = Freq / Freq_Original) %>%
ungroup() %>%
na.omit()
# Ajustar los nombres
variable_names <- list("educ_max" = "Nivel educacional \nde los padres",
"genero_ES" = "Género",
"libros_hogar" = "Cantidad de libros en el hogar")
variable_labeller <- function(variable, value){return(variable_names[value])}
# Ajustar las etiquetas largas
frecuencias$categoria <- str_wrap(frecuencias$categoria, width = 10)
colors <-  c("#0570b0ff", "#D0EAF1",
"#6C3483")
# Graficar las barras
ggplot(frecuencias, aes(x = categoria, y = Porcentaje, fill = factor(p3))) +
geom_bar(stat = "identity", position = "fill", color = "white") +
facet_wrap(~ variable, scales = "free_x", labeller = as_labeller(variable_labeller)) +
geom_shadowtext(aes(label = scales::percent(Porcentaje, accuracy = 1)),
position = position_stack(vjust = 0.5),
color = "white",   # Color del texto interno
bg.color = "grey30",  # Color del borde (sombra)
bg.r = 0.1,  # Radio de la sombra (ajústalo según necesites)
size = 4
) +
labs(
x = NULL,
y = NULL,
fill = "Preferencia",
title = "Figura 10: ¿Qué es más importante para obtener buenas notas, \nel esfuerzo o la inteligencia?") +
theme_blank() +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
strip.text = element_text(size = 9, face = "bold"),
axis.text.x = element_text(size = 9),
legend.position = "right",
plot.title = element_text(size = 12, face = "italic", color = "black")
) +
scale_fill_manual(values = colors,
labels = c(`1` = "Esfuerzo",
`2` = "Ambos",
`3` = "Talento"))
db_w02$p3 <- car::recode(db_w02$p3, "1=1; 2=1; 3=1; 4=1; 5=2; 6=3; 7=3; 8=3; 9=3; 10=3")
# Paso 2: Calcular las frecuencias originales
frecuencias_originales <- db_w02 %>%
pivot_longer(cols = c(genero, educ_max, libros_hogar),
names_to = "variable",
values_to = "categoria") %>%
group_by(variable, categoria) %>%
summarise(Freq_Original = n(), .groups = 'drop')
# Paso 3: Combinar las frecuencias originales con la base transformada
proc_datos_largo <- db_w02 %>%
pivot_longer(cols = c(genero, educ_max, libros_hogar),
names_to = "variable",
values_to = "categoria")
# Calcular las frecuencias con la pregunta correspondiente
frecuencias <- proc_datos_largo %>%
group_by(variable, categoria, p3) %>%
summarise(Freq = n(), .groups = 'drop') %>%
left_join(frecuencias_originales, by = c("variable", "categoria")) %>%
mutate(Porcentaje = Freq / Freq_Original) %>%
ungroup() %>%
na.omit()
# Ajustar los nombres
variable_names <- list("educ_max" = "Nivel educacional \nde los padres",
"genero_ES" = "Género",
"libros_hogar" = "Cantidad de libros en el hogar")
variable_labeller <- function(variable, value){return(variable_names[value])}
# Ajustar las etiquetas largas
frecuencias$categoria <- str_wrap(frecuencias$categoria, width = 10)
colors <-  c("#0570b0ff", "#D0EAF1",
"#6C3483")
# Graficar las barras
ggplot(frecuencias, aes(x = categoria, y = Porcentaje, fill = factor(p3))) +
geom_bar(stat = "identity", position = "fill", color = "white") +
facet_wrap(~ variable, scales = "free_x", labeller = as_labeller(variable_labeller)) +
geom_shadowtext(aes(label = scales::percent(Porcentaje, accuracy = 1)),
position = position_stack(vjust = 0.5),
color = "white",   # Color del texto interno
bg.color = "grey30",  # Color del borde (sombra)
bg.r = 0.1,  # Radio de la sombra (ajústalo según necesites)
size = 4
) +
labs(
x = NULL,
y = NULL,
fill = "Preferencia",
title = "Figura 10: ¿Qué es más importante para obtener buenas notas, \nel esfuerzo o la inteligencia?") +
theme_blank() +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
strip.text = element_text(size = 9, face = "bold"),
axis.text.x = element_text(size = 9),
legend.position = "right",
plot.title = element_text(size = 12, face = "italic", color = "black")
) +
scale_fill_manual(values = colors,
labels = c(`1` = "Esfuerzo",
`2` = "Ambos",
`3` = "Talento"))
db_w02$p3 <- car::recode(db_w02$p3, "1=1; 2=1; 3=1; 4=1; 5=2; 6=3; 7=3; 8=3; 9=3; 10=3")
# Calcular las frecuencias con la pregunta correspondiente
frecuencias <- proc_datos_largo %>%
group_by(variable, categoria, p3) %>%
summarise(Freq = n(), .groups = 'drop') %>%
left_join(frecuencias_originales, by = c("variable", "categoria")) %>%
mutate(Porcentaje = Freq / Freq_Original) %>%
ungroup() %>%
na.omit()
# Ajustar los nombres
variable_names <- list("educ_max" = "Nivel educacional \nde los padres",
"genero_ES" = "Género",
"libros_hogar" = "Cantidad de libros en el hogar")
variable_labeller <- function(variable, value){return(variable_names[value])}
# Ajustar las etiquetas largas
frecuencias$categoria <- str_wrap(frecuencias$categoria, width = 10)
colors <-  c("#0570b0ff", "#D0EAF1",
"#6C3483")
# Graficar las barras
ggplot(frecuencias, aes(x = categoria, y = Porcentaje, fill = factor(p3))) +
geom_bar(stat = "identity", position = "fill", color = "white") +
facet_wrap(~ variable, scales = "free_x", labeller = as_labeller(variable_labeller)) +
geom_shadowtext(aes(label = scales::percent(Porcentaje, accuracy = 1)),
position = position_stack(vjust = 0.5),
color = "white",   # Color del texto interno
bg.color = "grey30",  # Color del borde (sombra)
bg.r = 0.1,  # Radio de la sombra (ajústalo según necesites)
size = 4
) +
labs(
x = NULL,
y = NULL,
fill = "Preferencia",
title = "Figura 10: ¿Qué es más importante para obtener buenas notas, \nel esfuerzo o la inteligencia?") +
theme_blank() +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
strip.text = element_text(size = 9, face = "bold"),
axis.text.x = element_text(size = 9),
legend.position = "right",
plot.title = element_text(size = 12, face = "italic", color = "black")
) +
scale_fill_manual(values = colors,
labels = c(`1` = "Esfuerzo",
`2` = "Ambos",
`3` = "Talento"))
# Calcular las frecuencias con la pregunta correspondiente
frecuencias <- proc_datos_largo %>%
group_by(variable, categoria, p2_3) %>%
summarise(Freq = n(), .groups = 'drop') %>%
left_join(frecuencias_originales, by = c("variable", "categoria")) %>%
mutate(Porcentaje = Freq / Freq_Original) %>%
ungroup() %>%
na.omit()
# Ajustar los nombres
variable_names <- list("educ_max" = "Nivel educacional de los padres",
"genero_ES" = "Género",
"libros_hogar" = "Cantidad de libros en el hogar")
variable_labeller <- function(variable, value){return(variable_names[value])}
# Ajustar las etiquetas largas
frecuencias$categoria <- str_wrap(frecuencias$categoria, width = 10)
# Graficar las barras
ggplot(frecuencias, aes(x = categoria, y = Porcentaje, fill = factor(p2_3))) +
geom_bar(stat = "identity", position = "fill", color = "white") +
facet_wrap(~ variable, scales = "free_x", labeller = as_labeller(variable_labeller)) +
geom_shadowtext(aes(label = scales::percent(Porcentaje, accuracy = 1)),
position = position_stack(vjust = 0.5),
color = "white",   # Color del texto interno
bg.color = "grey30",  # Color del borde (sombra)
bg.r = 0.1,  # Radio de la sombra (ajústalo según necesites)
size = 4
) +
labs(
x = NULL,
y = NULL,
fill = "Grado de acuerdo",
title = "Figura 8: En esta escuela, los/as estudiantes obtienen las notas que merecen") +
theme_blank() +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
strip.text = element_text(size = 9, face = "bold"),
axis.text.x = element_text(size = 9),
legend.position = "bottom",
plot.title = element_text(size = 12, face = "italic", color = "black")
) +
scale_fill_brewer(palette = "Blues",
labels = c("1" = "Muy en desacuerdo", "2" = "En desacuerdo",
"3" = "De acuerdo", "4" = "Muy de acuerdo"),
name = NULL) +
coord_flip()
# Calcular las frecuencias con la pregunta correspondiente
frecuencias <- proc_datos_largo %>%
group_by(variable, categoria, p2_3) %>%
summarise(Freq = n(), .groups = 'drop') %>%
left_join(frecuencias_originales, by = c("variable", "categoria")) %>%
mutate(Porcentaje = Freq / Freq_Original) %>%
ungroup() %>%
na.omit()
# Ajustar los nombres
variable_names <- list("educ_max" = "Nivel educacional de los padres",
"genero_ES" = "Género",
"libros_hogar" = "Cantidad de libros en el hogar")
variable_labeller <- function(variable, value){return(variable_names[value])}
# Ajustar las etiquetas largas
frecuencias$categoria <- str_wrap(frecuencias$categoria, width = 10)
# Graficar las barras
ggplot(frecuencias, aes(x = Poecentaje, y = categoria, fill = factor(p2_3))) +
geom_bar(stat = "identity", position = "fill", color = "white") +
facet_wrap(~ variable, scales = "free_x", labeller = as_labeller(variable_labeller)) +
geom_shadowtext(aes(label = scales::percent(Porcentaje, accuracy = 1)),
position = position_stack(vjust = 0.5),
color = "white",   # Color del texto interno
bg.color = "grey30",  # Color del borde (sombra)
bg.r = 0.1,  # Radio de la sombra (ajústalo según necesites)
size = 4
) +
labs(
x = NULL,
y = NULL,
fill = "Grado de acuerdo",
title = "Figura 8: En esta escuela, los/as estudiantes obtienen las notas que merecen") +
theme_blank() +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
strip.text = element_text(size = 9, face = "bold"),
axis.text.x = element_text(size = 9),
legend.position = "bottom",
plot.title = element_text(size = 12, face = "italic", color = "black")
) +
scale_fill_brewer(palette = "Blues",
labels = c("1" = "Muy en desacuerdo", "2" = "En desacuerdo",
"3" = "De acuerdo", "4" = "Muy de acuerdo"),
name = NULL)
# Calcular las frecuencias con la pregunta correspondiente
frecuencias <- proc_datos_largo %>%
group_by(variable, categoria, p2_3) %>%
summarise(Freq = n(), .groups = 'drop') %>%
left_join(frecuencias_originales, by = c("variable", "categoria")) %>%
mutate(Porcentaje = Freq / Freq_Original) %>%
ungroup() %>%
na.omit()
# Ajustar los nombres
variable_names <- list("educ_max" = "Nivel educacional de los padres",
"genero_ES" = "Género",
"libros_hogar" = "Cantidad de libros en el hogar")
variable_labeller <- function(variable, value){return(variable_names[value])}
# Ajustar las etiquetas largas
frecuencias$categoria <- str_wrap(frecuencias$categoria, width = 10)
# Graficar las barras
ggplot(frecuencias, aes(x = Porcentaje, y = categoria, fill = factor(p2_3))) +
geom_bar(stat = "identity", position = "fill", color = "white") +
facet_wrap(~ variable, scales = "free_x", labeller = as_labeller(variable_labeller)) +
geom_shadowtext(aes(label = scales::percent(Porcentaje, accuracy = 1)),
position = position_stack(vjust = 0.5),
color = "white",   # Color del texto interno
bg.color = "grey30",  # Color del borde (sombra)
bg.r = 0.1,  # Radio de la sombra (ajústalo según necesites)
size = 4
) +
labs(
x = NULL,
y = NULL,
fill = "Grado de acuerdo",
title = "Figura 8: En esta escuela, los/as estudiantes obtienen las notas que merecen") +
theme_blank() +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
strip.text = element_text(size = 9, face = "bold"),
axis.text.x = element_text(size = 9),
legend.position = "bottom",
plot.title = element_text(size = 12, face = "italic", color = "black")
) +
scale_fill_brewer(palette = "Blues",
labels = c("1" = "Muy en desacuerdo", "2" = "En desacuerdo",
"3" = "De acuerdo", "4" = "Muy de acuerdo"),
name = NULL)
# Calcular las frecuencias con la pregunta correspondiente
frecuencias <- proc_datos_largo %>%
group_by(variable, categoria, p2_3) %>%
summarise(Freq = n(), .groups = 'drop') %>%
left_join(frecuencias_originales, by = c("variable", "categoria")) %>%
mutate(Porcentaje = Freq / Freq_Original) %>%
ungroup() %>%
na.omit()
# Ajustar los nombres
variable_names <- list("educ_max" = "Nivel educacional de los padres",
"genero_ES" = "Género",
"libros_hogar" = "Cantidad de libros en el hogar")
variable_labeller <- function(variable, value){return(variable_names[value])}
# Ajustar las etiquetas largas
frecuencias$categoria <- str_wrap(frecuencias$categoria, width = 10)
# Graficar las barras
ggplot(frecuencias, aes(x = Porcentaje, y = categoria, fill = factor(p2_3))) +
geom_bar(stat = "identity", position = "fill", color = "white") +
facet_wrap(~ variable, scales = "free_y", labeller = as_labeller(variable_labeller)) +
geom_shadowtext(aes(label = scales::percent(Porcentaje, accuracy = 1)),
position = position_stack(vjust = 0.5),
color = "white",   # Color del texto interno
bg.color = "grey30",  # Color del borde (sombra)
bg.r = 0.1,  # Radio de la sombra (ajústalo según necesites)
size = 4
) +
labs(
x = NULL,
y = NULL,
fill = "Grado de acuerdo",
title = "Figura 8: En esta escuela, los/as estudiantes obtienen las notas que merecen") +
theme_blank() +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
strip.text = element_text(size = 9, face = "bold"),
axis.text.x = element_text(size = 9),
legend.position = "bottom",
plot.title = element_text(size = 12, face = "italic", color = "black")
) +
scale_fill_brewer(palette = "Blues",
labels = c("1" = "Muy en desacuerdo", "2" = "En desacuerdo",
"3" = "De acuerdo", "4" = "Muy de acuerdo"),
name = NULL) +
coord_flip()
# Calcular las frecuencias con la pregunta correspondiente
frecuencias <- proc_datos_largo %>%
group_by(variable, categoria, p2_3) %>%
summarise(Freq = n(), .groups = 'drop') %>%
left_join(frecuencias_originales, by = c("variable", "categoria")) %>%
mutate(Porcentaje = Freq / Freq_Original) %>%
ungroup() %>%
na.omit()
# Ajustar los nombres
variable_names <- list("educ_max" = "Nivel educacional de los padres",
"genero_ES" = "Género",
"libros_hogar" = "Cantidad de libros en el hogar")
variable_labeller <- function(variable, value){return(variable_names[value])}
# Ajustar las etiquetas largas
frecuencias$categoria <- str_wrap(frecuencias$categoria, width = 10)
# Graficar las barras
ggplot(frecuencias, aes(x = Porcentaje, y = categoria, fill = factor(p2_3))) +
geom_bar(stat = "identity", position = "fill", color = "white") +
facet_wrap(~ variable, scales = "free_y", labeller = as_labeller(variable_labeller)) +
geom_shadowtext(aes(label = scales::percent(Porcentaje, accuracy = 1)),
position = position_stack(vjust = 0.5),
color = "white",   # Color del texto interno
bg.color = "grey30",  # Color del borde (sombra)
bg.r = 0.1,  # Radio de la sombra (ajústalo según necesites)
size = 4
) +
labs(
x = NULL,
y = NULL,
fill = "Grado de acuerdo",
title = "Figura 8: En esta escuela, los/as estudiantes obtienen las notas que merecen") +
theme_blank() +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
strip.text = element_text(size = 9, face = "bold"),
axis.text.x = element_text(size = 9),
legend.position = "bottom",
plot.title = element_text(size = 12, face = "italic", color = "black")
) +
scale_fill_brewer(palette = "Blues",
labels = c("1" = "Muy en desacuerdo", "2" = "En desacuerdo",
"3" = "De acuerdo", "4" = "Muy de acuerdo"),
name = NULL) + coord_flip()
# Calcular las frecuencias con la pregunta correspondiente
frecuencias <- proc_datos_largo %>%
group_by(variable, categoria, p2_3) %>%
summarise(Freq = n(), .groups = 'drop') %>%
left_join(frecuencias_originales, by = c("variable", "categoria")) %>%
mutate(Porcentaje = Freq / Freq_Original) %>%
ungroup() %>%
na.omit()
# Ajustar los nombres
variable_names <- list("educ_max" = "Nivel educacional de los padres",
"genero_ES" = "Género",
"libros_hogar" = "Cantidad de libros en el hogar")
variable_labeller <- function(variable, value){return(variable_names[value])}
# Ajustar las etiquetas largas
frecuencias$categoria <- str_wrap(frecuencias$categoria, width = 10)
# Graficar las barras
ggplot(frecuencias, aes(x = Porcentaje, y = categoria, fill = factor(p2_3))) +
geom_bar(stat = "identity", position = "fill", color = "white") +
facet_wrap(~ variable, scales = "free_y", labeller = as_labeller(variable_labeller)) +
geom_shadowtext(aes(label = scales::percent(Porcentaje, accuracy = 1)),
position = position_stack(vjust = 0.5),
color = "white",   # Color del texto interno
bg.color = "grey30",  # Color del borde (sombra)
bg.r = 0.1,  # Radio de la sombra (ajústalo según necesites)
size = 4
) +
labs(
x = NULL,
y = NULL,
fill = "Grado de acuerdo",
title = "Figura 8: En esta escuela, los/as estudiantes obtienen las notas que merecen") +
theme_blank() +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
strip.text = element_text(size = 9, face = "bold"),
axis.text.x = element_text(size = 9),
legend.position = "bottom",
plot.title = element_text(size = 12, face = "italic", color = "black")
) +
scale_fill_brewer(palette = "Blues",
labels = c("1" = "Muy en desacuerdo", "2" = "En desacuerdo",
"3" = "De acuerdo", "4" = "Muy de acuerdo"),
name = NULL)
